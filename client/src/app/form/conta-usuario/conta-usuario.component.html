<ngx-spinner [name]="initialSpinner" bdColor="transparent" size="medium" color="#39afdb" [fullScreen]="false"
    type="ball-scale-multiple">
    <p style="font-size: 20px; color: gray">Carregando...</p>
</ngx-spinner>
<notifier-container></notifier-container>
<div class="modal-header" *ngIf="modal">
    <h4 class="card-title" *ngIf="isCreating">Cadastrar novo usuário</h4>
    <h4 class="card-title" *ngIf="!isCreating">Dados do usuário</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss(); manageAccountForm.reset()">
        <span aria-hidden="true">&times;</span>
    </button>
</div>
<!-- Row -->
<div *ngIf="manageAccountForm">
    <div class="row">
        <div class="col-12">
            <div class="card">
                <hr class="m-t-0">
                <form class="form-horizontal striped-rows b-form" (ngSubmit)="formSubmit()"
                    [formGroup]="manageAccountForm" id="manageAccountForm">
                    <div class="card-body" [ngClass]="{'p-t-0': modal}">
                        <h4 class="card-title">Informações</h4>
                        <div class="form-group row">
                            <div class="col-sm-3">
                                <div class="b-label">
                                    <label for="nome" class="control-label col-form-label">Nome</label>
                                </div>
                            </div>
                            <div class="col-sm-6" *ngIf="(isEditing || isCreating) || !modal">
                                <input type="text" class="form-control" id="nome" placeholder="Nome"
                                    formControlName="nome" [ngClass]="{'is-invalid': manageAccountForm.get('nome').invalid  && (manageAccountForm.get('nome').dirty || 
                                    manageAccountForm.get('nome').touched)}">
                                <div class="invalid-feedback" *ngFor="let validation of getMessagesError('nome')">
                                    <span *ngIf="manageAccountForm.get('nome').hasError(validation.type) && (manageAccountForm.get('nome').dirty || 
                                    manageAccountForm.get('nome').touched)">{{validation.message}}</span>
                                </div>
                            </div>
                            <div class="col-sm-9" *ngIf="(!isEditing && !isCreating) && modal">
                                <div class="b-label b-label--start">
                                    <span class="control-label col-form-label">
                                        {{userData.nome}}
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-3">
                                <div class="b-label">
                                    <label for="sobrenome" class="control-label col-form-label">Sobrenome</label>
                                </div>
                            </div>
                            <div class="col-sm-6" *ngIf="(isEditing || isCreating) || !modal">
                                <input type="text" class="form-control" id="sobrenome" placeholder="Sobrenome"
                                    formControlName="sobrenome" [ngClass]="{'is-invalid': manageAccountForm.get('sobrenome').invalid  && (manageAccountForm.get('sobrenome').dirty || 
                                    manageAccountForm.get('sobrenome').touched)}">
                                <div class="invalid-feedback" *ngFor="let validation of getMessagesError('sobrenome')">
                                    <span *ngIf="manageAccountForm.get('sobrenome').hasError(validation.type) && (manageAccountForm.get('sobrenome').dirty || 
                                            manageAccountForm.get('sobrenome').touched)">{{validation.message}}</span>
                                </div>
                            </div>
                            <div class="col-sm-9" *ngIf="(!isEditing && !isCreating) && modal">
                                <div class="b-label b-label--start">
                                    <span class="control-label col-form-label">
                                        {{userData.sobrenome}}
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-3">
                                <div class="b-label">
                                    <label for="cgc" class="control-label col-form-label">CPF/CNPJ</label>
                                </div>
                            </div>
                            <div class="col-sm-6" *ngIf="(isEditing || isCreating) || !modal">
                                <input type="tel" class="form-control" id="cgc" placeholder="CPF/CNPJ"
                                    [textMask]="{mask: getMaskCgc, guide: false}" formControlName="cgc" [ngClass]="{'is-invalid': manageAccountForm.get('cgc').invalid  && (manageAccountForm.get('cgc').dirty || 
                                    manageAccountForm.get('cgc').touched)}">
                                <div class="invalid-feedback" *ngFor="let validation of getMessagesError('cgc')">
                                    <span *ngIf="manageAccountForm.get('cgc').hasError(validation.type) && (manageAccountForm.get('cgc').dirty || 
                                            manageAccountForm.get('cgc').touched)">{{validation.message}}</span>
                                </div>
                            </div>
                            <div class="col-sm-9" *ngIf="(!isEditing && !isCreating) && modal">
                                <div class="b-label b-label--start">
                                    <span class="control-label col-form-label">
                                        {{userData.cgc}}
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-3">
                                <div class="b-label">
                                    <label for="email" class="control-label col-form-label">Email</label>
                                </div>
                            </div>
                            <div class="col-sm-6" *ngIf="(isEditing || isCreating) || !modal">
                                <input type="email" class="form-control" id="email" placeholder="Email"
                                    formControlName="email" [ngClass]="{'is-invalid': manageAccountForm.get('email').invalid  && (manageAccountForm.get('email').dirty || 
                                    manageAccountForm.get('email').touched)}">
                                <div class="invalid-feedback" *ngFor="let validation of getMessagesError('email')">
                                    <span *ngIf="manageAccountForm.get('email').hasError(validation.type) && (manageAccountForm.get('email').dirty || 
                                            manageAccountForm.get('email').touched)">{{validation.message}}</span>
                                </div>
                            </div>
                            <div class="col-sm-9" *ngIf="(!isEditing && !isCreating) && modal">
                                <div class="b-label b-label--start">
                                    <span class="control-label col-form-label">
                                        {{userData.email}}
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-3">
                                <div class="b-label">
                                    <label for="telefone" class="control-label col-form-label">Telefone</label>
                                </div>
                            </div>
                            <div class="col-sm-6" *ngIf="(isEditing || isCreating) || !modal">
                                <input type="tel" class="form-control" id="telefone" placeholder="(31) 9 9999-9999"
                                    formControlName="telefone" [textMask]="{mask: telMask, guide: false}" [ngClass]="{'is-invalid': manageAccountForm.get('telefone').invalid  && (manageAccountForm.get('telefone').dirty || 
                                    manageAccountForm.get('telefone').touched)}">
                                <div class="invalid-feedback" *ngFor="let validation of getMessagesError('telefone')">
                                    <span *ngIf="manageAccountForm.get('telefone').hasError(validation.type) && (manageAccountForm.get('telefone').dirty || 
                                            manageAccountForm.get('telefone').touched)">{{validation.message}}</span>
                                </div>
                            </div>
                            <div class="col-sm-9" *ngIf="(!isEditing && !isCreating) && modal">
                                <div class="b-label b-label--start">
                                    <span class="control-label col-form-label">
                                        {{userData.telefone}}
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-3">
                                <div class="b-label">
                                    <label for="cargo" class="control-label col-form-label">Cargo</label>
                                </div>
                            </div>
                            <div class="col-sm-6" *ngIf="(isEditing || isCreating) || !modal">
                                <input type="text" class="form-control" id="cargo" placeholder="Cargo"
                                    formControlName="cargo" [ngClass]="{'is-invalid': manageAccountForm.get('cargo').invalid  && (manageAccountForm.get('cargo').dirty || 
                                    manageAccountForm.get('cargo').touched)}">
                                <div class="invalid-feedback" *ngFor="let validation of getMessagesError('cargo')">
                                    <span *ngIf="manageAccountForm.get('cargo').hasError(validation.type) && (manageAccountForm.get('cargo').dirty || 
                                            manageAccountForm.get('cargo').touched)">{{validation.message}}</span>
                                </div>
                            </div>
                            <div class="col-sm-9" *ngIf="(!isEditing && !isCreating) && modal">
                                <div class="b-label b-label--start">
                                    <span class="control-label col-form-label">
                                        {{userData.cargo}}
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-3">
                                <div class="b-label">
                                    <label for="dataNascimento" class="control-label col-form-label">Data de
                                        Nascimento</label>
                                </div>
                            </div>
                            <div class="col-sm-6" *ngIf="(isEditing || isCreating) || !modal">
                                <input type="date" class="form-control" id="dataNascimento"
                                    formControlName="dataNascimento" [ngClass]="{'is-invalid': manageAccountForm.get('dataNascimento').invalid  
                                    && (manageAccountForm.get('dataNascimento').dirty || 
                                    manageAccountForm.get('dataNascimento').touched)}">
                                <div class="invalid-feedback"
                                    *ngFor="let validation of getMessagesError('dataNascimento')">
                                    <span
                                        *ngIf="manageAccountForm.get('dataNascimento').hasError(validation.type) && (manageAccountForm.get('dataNascimento').dirty || 
                                            manageAccountForm.get('dataNascimento').touched)">{{validation.message}}</span>
                                </div>
                            </div>
                            <div class="col-sm-9" *ngIf="(!isEditing && !isCreating) && modal">
                                <div class="b-label b-label--start">
                                    <span class="control-label col-form-label">
                                        {{userData.dataNascimento}}
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr>
                    <div class="card-body">
                        <h4 class="card-title">Endereço</h4>
                        <div class="form-group row">
                            <div class="col-sm-3">
                                <div class="b-label">
                                    <label for="CEP" class="control-label col-form-label">CEP</label>
                                </div>
                            </div>
                            <div class="row py-0" [ngClass]="{'m-l-0': modal}" *ngIf="(isEditing || isCreating) || !modal">
                                <div class="col-sm-auto">
                                    <input type="text" class="form-control" id="CEP" placeholder="CEP"
                                        formControlName="cep" [textMask]="{mask: cepMask, guide: false}" [ngClass]="{'is-invalid': manageAccountForm.get('cep').invalid  && (manageAccountForm.get('cep').dirty || 
                                    manageAccountForm.get('cep').touched)}">
                                    <div class="invalid-feedback" *ngFor="let validation of getMessagesError('cep')">
                                        <span
                                            *ngIf="manageAccountForm.get('cep').hasError(validation.type) && (manageAccountForm.get('cep').dirty || 
                                                    manageAccountForm.get('cep').touched)">{{validation.message}}</span>
                                    </div>
                                </div>
                                <div class="col-sm-auto">
                                    <button type="button"
                                        [disabled]="manageAccountForm.get('cep').invalid || manageAccountForm.disabled"
                                        (click)="getAddressData()" class="btn btn-dark waves-effect waves-light">
                                        <span *ngIf="!isCepSpinnerShow">Buscar</span>
                                        <ngx-spinner [name]="cepSpinner" bdColor="transparent" size="default"
                                            color="#fff" type="ball-beat" [fullScreen]="false">
                                        </ngx-spinner>
                                    </button>
                                </div>
                            </div>
                            <div class="col-sm-9" *ngIf="(!isEditing && !isCreating) && modal">
                                <div class="b-label b-label--start">
                                    <span class="control-label col-form-label">
                                        {{userData.cep}}
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-3">
                                <div class="b-label">
                                    <label for="endereco" class="control-label col-form-label">Endereço</label>
                                </div>
                            </div>
                            <div class="col-sm-6" *ngIf="(isEditing || isCreating) || !modal">
                                <input type="text" class="form-control" formControlName="endereco" id="endereco"
                                    placeholder="Endereço">
                            </div>
                            <div class="col-sm-9" *ngIf="(!isEditing && !isCreating) && modal">
                                <div class="b-label b-label--start">
                                    <span class="control-label col-form-label">
                                        {{userData.endereco}}
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-3">
                                <div class="b-label">
                                    <label for="numero" class="control-label col-form-label">Número</label>
                                </div>
                            </div>
                            <div class="col-sm-6" *ngIf="(isEditing || isCreating) || !modal">
                                <input type="number" class="form-control" formControlName="numero" id="numero"
                                    placeholder="Número" [ngClass]="{'is-invalid': manageAccountForm.get('numero').invalid  && (manageAccountForm.get('numero').dirty || 
                                    manageAccountForm.get('numero').touched)}">
                                <div class="invalid-feedback" *ngFor="let validation of getMessagesError('numero')">
                                    <span
                                        *ngIf="manageAccountForm.get('numero').hasError(validation.type) && (manageAccountForm.get('numero').dirty || 
                                                            manageAccountForm.get('numero').touched)">{{validation.message}}</span>
                                </div>
                            </div>
                            <div class="col-sm-9" *ngIf="(!isEditing && !isCreating) && modal">
                                <div class="b-label b-label--start">
                                    <span class="control-label col-form-label">
                                        {{userData.numero}}
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-3">
                                <div class="b-label">
                                    <label for="complemento" class="control-label col-form-label">Complemento</label>
                                </div>
                            </div>
                            <div class="col-sm-6" *ngIf="(isEditing || isCreating) || !modal">
                                <input type="text" class="form-control" formControlName="complemento" id="complemento"
                                    placeholder="Complemento">
                            </div>
                            <div class="col-sm-9" *ngIf="(!isEditing && !isCreating) && modal">
                                <div class="b-label b-label--start">
                                    <span class="control-label col-form-label">
                                        {{userData.complemento}}
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-3">
                                <div class="b-label">
                                    <label for="bairro" class="control-label col-form-label">Bairro</label>
                                </div>
                            </div>
                            <div class="col-sm-6" *ngIf="(isEditing || isCreating) || !modal">
                                <input type="text" class="form-control" formControlName="bairro" id="bairro"
                                    placeholder="Bairro">
                            </div>
                            <div class="col-sm-9" *ngIf="(!isEditing && !isCreating) && modal">
                                <div class="b-label b-label--start">
                                    <span class="control-label col-form-label">
                                        {{userData.bairro}}
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-3">
                                <div class="b-label">
                                    <label for="cidade" class="control-label col-form-label">Cidade</label>
                                </div>
                            </div>
                            <div class="col-sm-6" *ngIf="(isEditing || isCreating) || !modal">
                                <input type="text" class="form-control" id="cidade" formControlName="cidade"
                                    placeholder="Cidade">
                            </div>
                            <div class="col-sm-9" *ngIf="(!isEditing && !isCreating) && modal">
                                <div class="b-label b-label--start">
                                    <span class="control-label col-form-label">
                                        {{userData.cidade}}
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-3">
                                <div class="b-label">
                                    <label for="estado" class="control-label col-form-label">Estado</label>
                                </div>
                            </div>
                            <div class="col-sm-6" *ngIf="(isEditing || isCreating) || !modal">
                                <input type="text" class="form-control" id="estado" formControlName="estado"
                                    placeholder="Estado">
                            </div>
                            <div class="col-sm-9" *ngIf="(!isEditing && !isCreating) && modal">
                                <div class="b-label b-label--start">
                                    <span class="control-label col-form-label">
                                        {{userData.estado}}
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr>
                    <div class="card-body">
                        <h4 class="card-title">Dados de Acesso</h4>
                        <div class="form-group row">
                            <div class="col-sm-3">
                                <div class="b-label">
                                    <label for="empresa" class="control-label col-form-label">Empresa</label>
                                </div>
                            </div>
                            <div class="col-sm-6" *ngIf="(isEditing || isCreating) || !modal">
                                <input type="text" class="form-control" id="empresa" placeholder="empresa"
                                    formControlName="empresa" [ngbTypeahead]="searchCompany"
                                    (focus)="focusCompany$.next($event.target.value)"
                                    (click)="clickCompany$.next($event.target.value)" #instance="ngbTypeahead"
                                    [ngClass]="{'is-invalid': manageAccountForm.get('empresa').invalid  && (manageAccountForm.get('empresa').dirty || 
                                    manageAccountForm.get('empresa').touched)}">
                                <div class="invalid-feedback" *ngFor="let validation of getMessagesError('empresa')">
                                    <span
                                        *ngIf="manageAccountForm.get('empresa').hasError(validation.type) && (manageAccountForm.get('empresa').dirty || 
                                                                manageAccountForm.get('empresa').touched)">{{validation.message}}</span>
                                </div>
                            </div>
                            <div class="col-sm-9" *ngIf="(!isEditing && !isCreating) && modal">
                                <div class="b-label b-label--start">
                                    <span class="control-label col-form-label">
                                        {{userData.empresa}}
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-3">
                                <div class="b-label">
                                    <label for="perfil" class="control-label col-form-label">Perfil</label>
                                </div>
                            </div>
                            <div class="col-sm-6" *ngIf="(isEditing || isCreating) || !modal">
                                <input type="text" class="form-control" formControlName="perfil" id="perfil"
                                    placeholder="perfil" [ngbTypeahead]="searchPermission"
                                    (focus)="focusPermission$.next($event.target.value)"
                                    (click)="clickPermission$.next($event.target.value)" #instance="ngbTypeahead"
                                    [ngClass]="{'is-invalid': manageAccountForm.get('perfil').invalid  && (manageAccountForm.get('perfil').dirty || 
                                    manageAccountForm.get('perfil').touched)}">
                                <div class="invalid-feedback" *ngFor="let validation of getMessagesError('perfil')">
                                    <span
                                        *ngIf="manageAccountForm.get('perfil').hasError(validation.type) && (manageAccountForm.get('perfil').dirty || 
                                                                manageAccountForm.get('perfil').touched)">{{validation.message}}</span>
                                </div>
                            </div>
                            <div class="col-sm-9" *ngIf="(!isEditing && !isCreating) && modal">
                                <div class="b-label b-label--start">
                                    <span class="control-label col-form-label">
                                        {{userData.perfil}}
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-3">
                                <div class="b-label">
                                    <label for="setor" class="control-label col-form-label">Setor</label>
                                </div>
                            </div>
                            <div class="col-sm-6" *ngIf="(isEditing || isCreating) || !modal">
                                <input type="text" class="form-control" id="setor" placeholder="Setor"
                                    formControlName="setor" [ngbTypeahead]="searchSector"
                                    (focus)="focusSector$.next($event.target.value)"
                                    (click)="clickSector$.next($event.target.value)" #instance="ngbTypeahead" [ngClass]="{'is-invalid': manageAccountForm.get('setor').invalid  && (manageAccountForm.get('setor').dirty || 
                                    manageAccountForm.get('setor').touched)}">
                                <div class="invalid-feedback" *ngFor="let validation of getMessagesError('setor')">
                                    <span
                                        *ngIf="manageAccountForm.get('setor').hasError(validation.type) && (manageAccountForm.get('setor').dirty || 
                                                                manageAccountForm.get('setor').touched)">{{validation.message}}</span>
                                </div>
                            </div>
                            <div class="col-sm-9" *ngIf="(!isEditing && !isCreating) && modal">
                                <div class="b-label b-label--start">
                                    <span class="control-label col-form-label">
                                        {{userData.setor}}
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr *ngIf="(isEditing || isCreating) || !modal">
                    <div class="card-body" *ngIf="(isEditing || isCreating) || !modal">
                        <h4 class="card-title" *ngIf="isEditing  || !modal">Alterar Senha</h4>
                        <h4 class="card-title" *ngIf="isCreating">Senha</h4>
                        <div class="form-group row">
                            <div class="col-sm-3">
                                <div class="b-label">
                                    <label for="newPassword" class="control-label col-form-label">Nova Senha</label>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <input type="password" class="form-control" formControlName="password" id="newPassword"
                                    placeholder="**********" [ngClass]="{'is-invalid': manageAccountForm.get('password').invalid  && (manageAccountForm.get('password').dirty || 
                                manageAccountForm.get('password').touched)}">
                                <div class="invalid-feedback" *ngFor="let validation of getMessagesError('password')">
                                    <span
                                        *ngIf="manageAccountForm.get('password').hasError(validation.type) && (manageAccountForm.get('password').dirty || 
                                                            manageAccountForm.get('password').touched)">{{validation.message}}</span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-3">
                                <div class="b-label">
                                    <label for="confirmNewPassword" class="control-label col-form-label">Confirmar Nova
                                        Senha</label>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <input type="password" class="form-control" id="confirmNewPassword"
                                    formControlName="confirmPassword" placeholder="**********" [ngClass]="{'is-invalid': manageAccountForm.get('confirmPassword').invalid  && (manageAccountForm.get('confirmPassword').dirty || 
                                    manageAccountForm.get('confirmPassword').touched)}">
                                <div class="invalid-feedback"
                                    *ngFor="let validation of getMessagesError('confirmPassword')">
                                    <span
                                        *ngIf="manageAccountForm.get('confirmPassword').hasError(validation.type) && (manageAccountForm.get('confirmPassword').dirty || 
                                                                manageAccountForm.get('confirmPassword').touched)">{{validation.message}}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card-body" *ngIf="(isEditing || isCreating) || !modal">
                        <div class="form-group m-b-0 text-right">
                            <button type="submit" class="btn btn-info waves-effect waves-light">
                                <span *ngIf="!manageAccountForm.disabled">Salvar</span>
                                <ngx-spinner [name]="saveSpinner" bdColor="transparent" size="default" color="#fff"
                                    type="ball-beat" [fullScreen]="false">
                                </ngx-spinner>
                            </button>
                            <button type="button" class="btn btn-secondary waves-effect waves-light"
                                (click)="resetForm()">Cancelar</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>